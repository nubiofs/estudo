<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN" "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr" class="js"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Generator" content="Drupal 7 (http://drupal.org)">
    <!-- base href="https://www.e-education.psu.edu/geog489/node/2321" -->
    <title>4.12.4 Modifications to the Original Project Files</title>
    <script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/jquery.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/jquery-extend-3.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/jquery_002.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/drupal.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/shCore.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/shBrushBash.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/shBrushJScript.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/shBrushJson.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/shBrushPhp.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/shBrushPowerShell.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/shBrushPython.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/shBrushVb.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/printable_links.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/toggler.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/lti.js"></script>
<script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/h5p-resizer.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/geog489\/","pathPrefix":"","ajaxPageState":{"theme":"gis","theme_token":"iPpYHCDhLtB8bAQ3GkzKFwHcSfqKeNO1JdyneMuXNC8","js":{"sites\/all\/modules\/jquery_update\/replace\/jquery\/1.7\/jquery.min.js":1,"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shCore.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushBash.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushJScript.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushJson.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushPhp.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushPowerShell.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushPython.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushVb.js":1,"sites\/all\/modules\/custom_js_libraries\/printable_links\/printable_links.js":1,"sites\/all\/modules\/custom_js_libraries\/toggler\/toggler.js":1,"sites\/all\/themes\/gis\/lti.js":1,"sites\/all\/themes\/gis\/..\/..\/modules\/h5p\/library\/js\/h5p-resizer.js":1}}});
//--><!]]>
</script>
        <meta name="robots" content="noindex, nofollow">        <style type="text/css" media="all">
@import url("https://www.e-education.psu.edu/geog489/modules/system/system.base.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/system/system.menus.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/system/system.messages.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/system/system.theme.css?psbola");
</style>
<style type="text/css" media="all">
@import url("https://www.e-education.psu.edu/geog489/modules/book/book.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/field/theme/field.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/node/node.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/quiz/quiz.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/search/search.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/user/user.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/extlink/extlink.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/views/css/views.css?psbola");
</style>
<link type="text/css" rel="stylesheet" href="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/css_002.css" media="all">
<link type="text/css" rel="stylesheet" href="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/css_003.css" media="all">
<link type="text/css" rel="stylesheet" href="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/css.css" media="all">
<style type="text/css" media="all">
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/hidden_nodes/hidden_nodes.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/ctools/css/ctools.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/libraries/syntaxhighlighter_3.0.83/styles/shCore.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/libraries/syntaxhighlighter_3.0.83/styles/shThemeDefault.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/taxonomy_access/taxonomy_access.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/print/print_ui/css/print_ui.theme.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/print/css/print.css?psbola");
</style>
  </head>
  <body>
            <div class="print-site_name">Published on <em class="placeholder">GEOG 489: Advanced Python Programming for GIS</em> (<a href="https://www.e-education.psu.edu/geog489">https://www.e-education.psu.edu/geog489</a>)</div>
    <p>
    </p><div class="print-breadcrumb"><a href="https://www.e-education.psu.edu/geog489/home.html">Home</a> &gt; <a href="https://www.e-education.psu.edu/geog489/node/1405">GEOG 489</a> &gt; <a href="https://www.e-education.psu.edu/geog489/l4.html">Lesson 4 Object-Oriented Programming in Python and QGIS Development</a> &gt; <a href="https://www.e-education.psu.edu/geog489/node/2316">4.12 Optional: Turning the Bus Event Analyzer into a QGIS Plugin</a> &gt; 4.12.4 Modifications to the Original Project Files</div>
    <hr class="print-hr">
        <div class="print-content"><div id="node-2321" class="section-4">
  <h1 class="book-heading">4.12.4 Modifications to the Original Project Files</h1>
  <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>The
 next thing we are going to do is make a few smaller changes to the 
files we copied over from the original project. First of all, it is 
unfortunately required that we adapt all import statements in which we 
are importing .py files located in the project folder. The reason is 
that when we write something like</p>

<pre class="brush: &lt;inserttype&gt;">from core_classes import BusTracker 
</pre>

<p>, this will work fine when the file core_classes.py is located in the
 current working directory when the program is executed. This is usually
 the same folder in which the main Python script is located. Therefore, 
we didn’t have any problems when executing main.py since main.py and the
 other .py files we wrote are all in the same directory. However, when 
being run as a QGIS plugin, the working directory will not be the folder
 containing the plugin code. As a result, you will get error messages 
when trying to import the other .py files like this. What we have to do 
is adapt the import statements to start with a dot which tells Python to
 look for the file <em>in the same folder the file in which the import statement appears is located</em>. So the previous example needs to become:</p>

<pre class="brush: &lt;inserttype&gt;">from .core_classes import BusTracker 
</pre>

<p>Here is quick overview of where we have to make these changes:</p>

<ol><li>In bus_events.py change the import statement at the beginning to:
		<div><div id="highlighter_723345" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">.core_classes </code><code class="python keyword">import</code> <code class="python plain">Depot, BusTracker</code></div></div></td></tr></tbody></table></div></div>
	</li>
	<li>In bus_track_analyzer.py change the two import statement at the beginning to:
		<div><div id="highlighter_529090" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">.bus_events </code><code class="python keyword">import</code> <code class="python plain">BusEvent </code></div><div class="line number2 index1 alt1"><code class="python keyword">from</code> <code class="python plain">.core_classes </code><code class="python keyword">import</code> <code class="python plain">BusTracker, Observation, Depot</code></div></div></td></tr></tbody></table></div></div>
	</li>
	<li>Lastly, in bus_tracker_widget.py change the import statement at the beginning to:
		<div><div id="highlighter_244682" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">.core_classes </code><code class="python keyword">import</code> <code class="python plain">BusTracker</code></div></div></td></tr></tbody></table></div></div>
	</li>
</ol><p>In addition to adapting the import statement, we are going to 
slightly adapt the bus_track_analyzer.py code to better work in concert 
with the GUI related classes of our plugin code: We are going to add the
 functionality to emit signals that we can connect to using the QT 
signal-slot approach. The two signals we are going to add are the 
following:</p>

<ul><li>observationProcessed: This signal will be emitted at the end of the <em>nextStep</em><em>()</em>
 method, so whenever the BusTrackAnalyzer object is done with processing
 one observation, the observation object that has just been processed 
will be included with the signal.</li>
	<li>eventDetected: This signal will be emitted for each new event that is added to the <em>allEvents</em> list. The emitted signal includes the new bus event object.</li>
</ul><p>Both signals will be used to connect an object of a new class we
 are going to write in Section 4.12.6 that has the purpose of showing 
the developing bus tracks and detected events live in QGIS. For this, it
 is required that the object is informed about newly processed 
observations and newly detected events, and this is what we are going to
 facilitate with these signals. Luckily, adding these signals to 
bus_track_analyzer.py just requires you to make a few small changes:</p>

<ol start="4"><li>Add the following PyQt5 import statement somewhere <em>before</em> line&nbsp;that starts the class definition with “class BusTrackAnalyzer …”:

		<div><div id="highlighter_859598" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code> <code class="python plain">PyQt5.QtCore </code><code class="python keyword">import</code> <code class="python plain">QObject, pyqtSignal</code></div></div></td></tr></tbody></table></div></div>
	</li>
	<li>To be able to emit signals we need the class BusTrackerAnalyzer to 
be derived from the QT class QObject we are importing with the newly 
added import statement. Therefore, please change the first line of the 
class definition to:
		<div><div id="highlighter_948862" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">class</code> <code class="python plain">BusTrackAnalyzer(QObject):</code></div></div></td></tr></tbody></table></div></div>
	</li>
	<li>Then directly <em>before</em> the start of the constructor with 
“def __init__...", add the following two lines indented relative to the 
“class BusTrackAnalyzer…” but not part of any method:
		<div><div id="highlighter_234060" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">observationProcessed </code><code class="python keyword">=</code> <code class="python plain">pyqtSignal(Observation) </code></div><div class="line number2 index1 alt1"><code class="python plain">eventDetected </code><code class="python keyword">=</code> <code class="python plain">pyqtSignal(BusEvent)</code></div></div></td></tr></tbody></table></div></div>

		<p>With these two lines we are defining the two signals that can be 
emitted by this class and the types of the parameters they will include.</p>
	</li>
	<li>Since we are now deriving BusTrackAnalyzer from QObject, we should 
call the constructor of the base class QObject from the first line of 
our <em>__init__(…) </em>method. So please add the following line there:
		<div><div id="highlighter_770259" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python functions">super</code><code class="python plain">(BusTrackAnalyzer, </code><code class="python color1">self</code><code class="python plain">).__init__()</code></div></div></td></tr></tbody></table></div></div>
	</li>
	<li>The last two changes we need to make are both in the definition of the <em>nextStep</em><em>()</em> method. We therefore show the entire new version of that method here:
		<div><div id="highlighter_243096" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">nextStep(</code><code class="python color1">self</code><code class="python plain">): </code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""performs next step by processing Observation at the front of the Observations priority queue"""</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">observation </code><code class="python keyword">=</code> <code class="python plain">heapq.heappop(</code><code class="python color1">self</code><code class="python plain">._observationQueue)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code><code class="python comments"># get Observation that is at front of queue </code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># go through list of BusEvent subclasses and invoke their detect() method; then collect the events produced </code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># and add them to the allEvents lists </code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">evClass </code><code class="python keyword">in</code> <code class="python color1">self</code><code class="python plain">._eventClasses: </code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">eventsProduced </code><code class="python keyword">=</code> <code class="python plain">evClass.detect(observation, </code><code class="python color1">self</code><code class="python plain">._depotData, </code><code class="python color1">self</code><code class="python plain">.allBusTrackers) </code><code class="python comments"># invoke event detection method </code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.allEvents.extend(eventsProduced)&nbsp; </code><code class="python comments"># add resulting events to event list </code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code> <code class="python plain">event </code><code class="python keyword">in</code> <code class="python plain">eventsProduced:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.eventDetected.emit(event) </code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># update BusTracker of Observation that was just processed </code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">observation.busTracker.lastProcessedIndex </code><code class="python keyword">+</code><code class="python keyword">=</code> <code class="python value">1</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">observation.busTracker.updateSpeed() </code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">observation.busTracker.status </code><code class="python keyword">=</code><code class="python keyword">=</code> <code class="python plain">BusTracker.STATUS_STOPPED: </code><code class="python comments"># if&nbsp; duration of a stopped event has just expired, change status to "DRIVING" </code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">observation.timepoint.time &gt; observation.busTracker.statusEvent.timepoint.time </code><code class="python keyword">+</code> <code class="python plain">observation.busTracker.statusEvent.duration: </code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">observation.busTracker.status </code><code class="python keyword">=</code> <code class="python plain">BusTracker.STATUS_DRIVING </code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">observation.busTracker.statusEvent </code><code class="python keyword">=</code> <code class="python color1">None</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># if this was not the last GPS Timepoint of this bus, create new Observation for the next point and add it to the Observation queue </code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code> <code class="python plain">observation.timepointIndex &lt; </code><code class="python functions">len</code><code class="python plain">(observation.busTracker.bus.timepoints) </code><code class="python keyword">-</code> <code class="python value">1</code><code class="python plain">:&nbsp; </code><code class="python comments"># not last point </code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">heapq.heappush(</code><code class="python color1">self</code><code class="python plain">._observationQueue, Observation(observation.busTracker, observation.timepointIndex </code><code class="python keyword">+</code> <code class="python value">1</code><code class="python plain">)&nbsp; )&nbsp; </code></div><div class="line number25 index24 alt2">&nbsp;</div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># update analyzer status </code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.lastProcessedTimepoint </code><code class="python keyword">=</code> <code class="python plain">observation.timepoint </code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.observationProcessed.emit(observation)</code></div></div></td></tr></tbody></table></div></div>

		<p>In lines 10 and 11&nbsp;of this new version we added a for-loop that goes through the events produced by the previous call of <em>detect(…)</em>
 and emit an eventDetected signal for each using the bus event object as
 a parameter. In the last line of the method, we do the same with the 
observationProcessed signal including the just processed Observation 
object.</p>
	</li>
</ol></div></div></div>  </div>
</div>
    <div class="print-footer">
</div>
    <hr class="print-hr">
          <div class="print-source_url">
        <strong>Source URL:</strong> https://www.e-education.psu.edu/geog489/node/2321      </div>
        <div class="print-links"></div>
    <script type="text/javascript" src="4.12.4%20Modifications%20to%20the%20Original%20Project%20Files_arquivos/syntaxhighlighter.js"></script>
  

</body></html>
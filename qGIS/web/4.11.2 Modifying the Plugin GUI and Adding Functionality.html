<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN" "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr" class="js"><head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="Generator" content="Drupal 7 (http://drupal.org)">
    <!-- base href="https://www.e-education.psu.edu/geog489/node/2358" -->
    <title>4.11.2 Modifying the Plugin GUI and Adding Functionality</title>
    <script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/jquery.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/jquery-extend-3.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/jquery_002.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/drupal.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/shCore.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/shBrushBash.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/shBrushJScript.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/shBrushJson.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/shBrushPhp.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/shBrushPowerShell.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/shBrushPython.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/shBrushVb.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/printable_links.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/toggler.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/lti.js"></script>
<script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/h5p-resizer.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/geog489\/","pathPrefix":"","ajaxPageState":{"theme":"gis","theme_token":"Q71qvuhQpAWF7Obyg2trpECtDnciZ3E9AtA3JwnGc-E","js":{"sites\/all\/modules\/jquery_update\/replace\/jquery\/1.7\/jquery.min.js":1,"misc\/jquery-extend-3.4.0.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shCore.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushBash.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushJScript.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushJson.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushPhp.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushPowerShell.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushPython.js":1,"sites\/all\/libraries\/syntaxhighlighter_3.0.83\/scripts\/shBrushVb.js":1,"sites\/all\/modules\/custom_js_libraries\/printable_links\/printable_links.js":1,"sites\/all\/modules\/custom_js_libraries\/toggler\/toggler.js":1,"sites\/all\/themes\/gis\/lti.js":1,"sites\/all\/themes\/gis\/..\/..\/modules\/h5p\/library\/js\/h5p-resizer.js":1}}});
//--><!]]>
</script>
        <meta name="robots" content="noindex, nofollow">        <style type="text/css" media="all">
@import url("https://www.e-education.psu.edu/geog489/modules/system/system.base.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/system/system.menus.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/system/system.messages.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/system/system.theme.css?psbola");
</style>
<style type="text/css" media="all">
@import url("https://www.e-education.psu.edu/geog489/modules/book/book.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/field/theme/field.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/node/node.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/quiz/quiz.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/search/search.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/modules/user/user.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/extlink/extlink.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/views/css/views.css?psbola");
</style>
<link type="text/css" rel="stylesheet" href="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/css_002.css" media="all">
<link type="text/css" rel="stylesheet" href="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/css_003.css" media="all">
<link type="text/css" rel="stylesheet" href="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/css.css" media="all">
<style type="text/css" media="all">
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/hidden_nodes/hidden_nodes.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/ctools/css/ctools.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/libraries/syntaxhighlighter_3.0.83/styles/shCore.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/libraries/syntaxhighlighter_3.0.83/styles/shThemeDefault.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/taxonomy_access/taxonomy_access.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/print/print_ui/css/print_ui.theme.css?psbola");
@import url("https://www.e-education.psu.edu/geog489/sites/all/modules/print/css/print.css?psbola");
</style>
  </head>
  <body>
            <div class="print-site_name">Published on <em class="placeholder">GEOG 489: Advanced Python Programming for GIS</em> (<a href="https://www.e-education.psu.edu/geog489">https://www.e-education.psu.edu/geog489</a>)</div>
    <p>
    </p><div class="print-breadcrumb"><a href="https://www.e-education.psu.edu/geog489/home.html">Home</a> &gt; <a href="https://www.e-education.psu.edu/geog489/node/1405">GEOG 489</a> &gt; <a href="https://www.e-education.psu.edu/geog489/l4.html">Lesson 4 Object-Oriented Programming in Python and QGIS Development</a> &gt; <a href="https://www.e-education.psu.edu/geog489/l4_p9.html">4.11 Optional: Writing QGIS Plugins</a> &gt; 4.11.2 Modifying the Plugin GUI and Adding Functionality</div>
    <hr class="print-hr">
        <div class="print-content"><div id="node-2358" class="section-4">
  <h1 class="book-heading">4.11.2 Modifying the Plugin GUI and Adding Functionality</h1>
  <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p>The
 file random_number_generator_dialog.py defines the class 
RandomNumberGeneratorDialog derived from QDialog. This is the widget 
class for our dialog box. The GUI itself is defined in the .ui file 
random_number_generator_dialog_base.ui. In contrast to first compiling 
the .ui file into a Python .py file and then using the Python code 
resulting from this to set up the GUI, this class uses the previously 
briefly mentioned approach of directly reading in the .ui file. That 
means to change the GUI, all we have to do is modify the .ui file in QT 
Designer, no compilation needed.</p>

<p>We open random_number_generator_dialog_base.ui with QT Designer and make the following small changes:</p>

<ul><li>We delete the button box with the Ok and cancel buttons.</li>
	<li>The layout of the dialog box is changed to a vertical layout.</li>
	<li>We add a push button and a label to the dialog box with vertical spacers in between.</li>
	<li>The button text is set to “Press here to generate random number between 1 and 100”.</li>
	<li>The label text is set to “The number is:” and its horizontal alignment property is changed to be horizontally&nbsp;centered.</li>
</ul><p>The image below shows the produced layout in QT Designer.</p>

<div class="img-center"><img alt="screenshot of layout and object inspector" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/random_in_designer_0.jpg"> &nbsp; &nbsp; &nbsp;
	<div class="img-caption">Figure 4.36 Creating the GUI for our plugin in QT Designer</div>
</div>

<p>After saving the form, we want to see whether we now get the new 
version of the GUI in QGIS as well. However, for this to happen, the 
plugin needs to be reloaded. For this, we use the Plugin Reloader plugin
 that we also installed at the beginning of the lesson. We pick the 
Plugins -&gt; Plugin Reloader -&gt; Configure option. Then we pick our 
randomnumbergenerator plugin from the list and press Ok.</p>

<div class="img-center"><img alt="screenshot of reloader with select plugin and ok options" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/plugin_reloader.jpg"> &nbsp; &nbsp; &nbsp;
	<div class="img-caption">Figure 4.37 Configuring Plugin Reloader to reload the code for our plugin</div>
</div>

<p>Now we just have to go Plugins -&gt; Plugin Reloader -&gt; Reload: 
randomnumbergenerator, whenever we want to reload the plugin after 
making some changes. After doing so and starting our plugin again, it 
should show up like this in QGIS:</p>

<div class="img-center"><img alt="screenshot of plugin with layout in popup window" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/newgui_in_qgis.jpg"> &nbsp; &nbsp; &nbsp;
	<div class="img-caption">Figure 4.38 Running the plugin in QGIS now shows the dialog box with the GUI we just created</div>
</div>

<p>Now we just have to implement the functionality for our plugin, which
 for this toy example is extremely simple. We just need to write some 
code for rolling a random number between 1 and 100 and updating&nbsp;the
 text of the label accordingly when the button is pressed. We implement 
this in the definition of our class RandomNumberGeneratorDialog in file 
random_number_generator_dialog.py. The changes we make are the 
following:</p>

<ul><li>In the line where the os module is imported, we also import the random module from the Python standard library.</li>
	<li>We add a new method to the class definition with the event handler code:
		<div><div id="highlighter_670133" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">def</code> <code class="python plain">generateNewNumber(</code><code class="python color1">self</code><code class="python plain">): </code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">random.randint(</code><code class="python value">1</code><code class="python plain">,</code><code class="python value">100</code><code class="python plain">) </code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.label.setText(</code><code class="python string">"The number is: "</code> <code class="python keyword">+</code> <code class="python functions">str</code><code class="python plain">(r))</code></div></div></td></tr></tbody></table></div></div>
	</li>
	<li>Finally, we connect the button to this new method by adding the following line at the end of the <em>__init__()</em> method:
		<div><div id="highlighter_783681" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python color1">self</code><code class="python plain">.pushButton.clicked.connect(</code><code class="python color1">self</code><code class="python plain">.generateNewNumber)</code></div></div></td></tr></tbody></table></div></div>
	</li>
</ul><p>Below is the entire code part of random_number_generator_dialog.py after making these changes:</p>

<div><div id="highlighter_873249" class="syntaxhighlighter  python"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table cellspacing="0" cellpadding="0" border="0"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">os, random </code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="python keyword">from</code> <code class="python plain">PyQt5 </code><code class="python keyword">import</code> <code class="python plain">uic </code></div><div class="line number4 index3 alt1"><code class="python keyword">from</code> <code class="python plain">PyQt5 </code><code class="python keyword">import</code> <code class="python plain">QtWidgets </code></div><div class="line number5 index4 alt2">&nbsp;</div><div class="line number6 index5 alt1"><code class="python plain">FORM_CLASS, _ </code><code class="python keyword">=</code> <code class="python plain">uic.loadUiType(os.path.join( os.path.dirname(__file__), </code><code class="python string">'random_number_generator_dialog_base.ui'</code><code class="python plain">)) </code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;</code>&nbsp;</div><div class="line number8 index7 alt1"><code class="python keyword">class</code> <code class="python plain">RandomNumberGeneratorDialog(QtWidgets.QDialog, FORM_CLASS): </code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">__init__(</code><code class="python color1">self</code><code class="python plain">, parent</code><code class="python keyword">=</code><code class="python color1">None</code><code class="python plain">): </code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">"""Constructor."""</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">super</code><code class="python plain">(RandomNumberGeneratorDialog, </code><code class="python color1">self</code><code class="python plain">).__init__(parent) </code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># Set up the user interface from Designer. </code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># After setupUI you can access any designer object by doing </code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># self.&lt;objectname&gt;, and you can use autoconnect slots - see </code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># <a href="http://qt-project.org/doc/qt-4.8/designer-using-a-ui-file.html">http://qt-project.org/doc/qt-4.8/designer-using-a-ui-file.html</a> </code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments"># #widgets-and-dialogs-with-auto-connect </code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.setupUi(</code><code class="python color1">self</code><code class="python plain">) </code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.pushButton.clicked.connect(</code><code class="python color1">self</code><code class="python plain">.generateNewNumber) </code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code> <code class="python plain">generateNewNumber(</code><code class="python color1">self</code><code class="python plain">): </code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r </code><code class="python keyword">=</code> <code class="python plain">random.randint(</code><code class="python value">1</code><code class="python plain">,</code><code class="python value">100</code><code class="python plain">) </code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.label.setText(</code><code class="python string">"The number is: "</code> <code class="python keyword">+</code> <code class="python functions">str</code><code class="python plain">(r))</code></div></div></td></tr></tbody></table></div></div>

<p>Now the only thing we have to do is reload the plugin again in QGIS, 
and when we then start the plugin one more time, the button should work 
and allow us to create random numbers. Please note that the dialog box 
is opened non-modally from our main plugin class so that you can keep 
the dialog box open in the background while still interacting with the 
rest of the QGIS GUI.</p>

<div class="img-center"><img alt="screenshot of plugin working: random number is 56" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/toyexampledone.jpg"> &nbsp; &nbsp; &nbsp;
	<div class="img-caption">Figure 4.39 The Random Number Generator plugin in QGIS after adding the main functionality</div>
</div>

<p>In this small example, all code changes needed were about wiring up 
the GUI of the dialog box. In such cases, modifying the file with the 
class definition for the main widget can be sufficient. In the 
next&nbsp;section, we will implement a plugin that is significantly more
 complex and interacts with QGIS in more sophisticated ways, e.g., by 
adding new layers to the currently open project and continuously 
updating the content of these layers. However, the general approach is 
the same in that we are mainly going to modify the .ui file and the file
 with the main widget class from the template files created by Plugin 
Builder 3. If you want to learn more about QGIS plugin development and 
the role the other files play, the <a href="https://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/plugins.html">official documentation</a> <span class="print-footnote">[1]</span> is a good starting point.</p>
</div></div></div>  </div>
</div>
    <div class="print-footer">
</div>
    <hr class="print-hr">
          <div class="print-source_url">
        <strong>Source URL:</strong> https://www.e-education.psu.edu/geog489/node/2358      </div>
        <div class="print-links"><p><strong>Links</strong><br>[1] https://docs.qgis.org/testing/en/docs/pyqgis_developer_cookbook/plugins.html<br>
</p></div>
    <script type="text/javascript" src="4.11.2%20Modifying%20the%20Plugin%20GUI%20and%20Adding%20Functionality_arquivos/syntaxhighlighter.js"></script>
  

</body></html>


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Disponibilizando os mapas de forma rica na web - OpenLayers &amp; Ol4JSF &mdash; GeoDOJO vGeoDOJO documentation</title>
    <link rel="stylesheet" href="../_static/geotools-tutorial.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'GeoDOJO',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="GeoDOJO vGeoDOJO documentation" href="../index.html" />
    <link rel="next" title="Exemplo1 - Enviando um geotwitt" href="../8-exemplo1/exemplo1.html" />
    <link rel="prev" title="Serviço de Mapas na Web - Geoserver" href="../6-geoserver/geoserver.html" /> 
  </head>
  <body>
    <div class="header">
        <div class="wrap">
            <ul id="top-nav">
                <li><a href="http://www.latinoware.org/">Latinoware 2010</a></li>
            </ul>
        </div>
    </div>

    <div class="related">
      <ul id="breadcrumbs">
            <li class="right" style="margin-right: 10px">
              <a href="../genindex.html" title="General Index"
                 accesskey="I">index</a></li>
            <li class="right" >
              <a href="../8-exemplo1/exemplo1.html" title="Exemplo1 - Enviando um geotwitt"
                 accesskey="N">next</a> |</li>
            <li class="right" >
              <a href="../6-geoserver/geoserver.html" title="Serviço de Mapas na Web - Geoserver"
                 accesskey="P">previous</a> |</li>
        <li><a href="../index.html">GeoDOJO vGeoDOJO documentation</a> &raquo;</li>
        <li><a href="#">Disponibilizando os mapas de forma rica na web - OpenLayers &amp; Ol4JSF</a></li>
      </ul>
    </div>


    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="disponibilizando-os-mapas-de-forma-rica-na-web-openlayers-ol4jsf">
<h1><a class="toc-backref" href="#id1">Disponibilizando os mapas de forma rica na web - OpenLayers &amp; Ol4JSF</a><a class="headerlink" href="#disponibilizando-os-mapas-de-forma-rica-na-web-openlayers-ol4jsf" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#disponibilizando-os-mapas-de-forma-rica-na-web-openlayers-ol4jsf" id="id1">Disponibilizando os mapas de forma rica na web - OpenLayers &amp; Ol4JSF</a><ul>
<li><a class="reference internal" href="#openlayers-ol4jsf" id="id2">OpenLayers &amp; OL4JSF</a></li>
<li><a class="reference internal" href="#instalacao-do-ol4jsf" id="id3">Instalação do OL4JSF</a></li>
<li><a class="reference internal" href="#exibindo-nosso-primeiro-mapa" id="id4">Exibindo nosso primeiro mapa</a><ul>
<li><a class="reference internal" href="#adicionando-controles" id="id5">Adicionando controles</a></li>
<li><a class="reference internal" href="#obtendo-mais-informacoes-a-partir-do-mapa" id="id6">Obtendo mais informações a partir do mapa</a></li>
<li><a class="reference internal" href="#ol4jsf-proxy" id="id7">OL4JSF Proxy</a></li>
<li><a class="reference internal" href="#obtendo-features-a-partir-de-um-backing-bean" id="id8">Obtendo features a partir de um backing bean</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Nesse capítulo vamos entender qual a relação existente entre o OpenLayers e o OL4JSF. Aprenderemos como instalar, configurar e utilizar os recursos disponíveis no OL4JSF em nossas aplicações JEE.</p>
<div class="section" id="openlayers-ol4jsf">
<h2><a class="toc-backref" href="#id2">OpenLayers &amp; OL4JSF</a><a class="headerlink" href="#openlayers-ol4jsf" title="Permalink to this headline">¶</a></h2>
<p>O OpenLayers é uma biblioteca javascript, opensource, que possui uma grande variedade de recursos para plotagem de mapas nos principais navegadores do mercado. Se ela é tão boa assim, então qual o problema?</p>
<p>Um dos grandes problemas não é a API em si, mas o javascript. Por ser uma linguagem dinâmica, as IDEs não conseguem ajudar muito e os desenvolvedores acabam sempre tendo que recorrer para a documentação para fazer as mínimas coisas. Em qual pacote está a classe responsável por exibir o mapa? Quais são parâmetros para instanciação? Enfim, cabe ao desenvolvedor conhecer cada detalhe da API através da documentação.</p>
<p>É nesse cenário que entra o OL4JSF. Ele encapsula boa parte da lógica responsável pela instanciação dos objetos OpenLayers e ainda, pelo fato de ser um conjunto de componentes JSF, integra-se perfeitamente aos ambientes de desenvolvimento JEE atuais: auto completar, ajuda contextual, janela de propriedades, palheta de componentes, etc.</p>
<p>Mas agora vem a melhor parte. O OL4JSF já foi concebido para facilitar o desenvolvimento, porém sem &#8220;engessá-lo&#8221;. Como assim? Desenvolvedores experientes com OpenLayers na maioria das vezes vão querer ter a possibilidade de acessar os recursos da API diretamente. Além disso, nem todas as funcionalidades existentes no OpenLayers estarão disponíveis no OL4JSF, ou pelo menos, poderão levar um certo tempo para serem implementadas. Sendo assim, os componentes OL4JSF podem ser disponibilizados para o contexto javascript na forma de variáveis globais e serem acessados normalmente em qualquer código javascript da página. Adicionalmente, o OL4JSF já disponibiliza um componente <em>&lt;m:script /&gt;</em> que possibilita a inserção de código javascript diretamente na elaboração do mapa. Então, que tal visualizarmos isso e muito mais na prática?</p>
</div>
<div class="section" id="instalacao-do-ol4jsf">
<h2><a class="toc-backref" href="#id3">Instalação do OL4JSF</a><a class="headerlink" href="#instalacao-do-ol4jsf" title="Permalink to this headline">¶</a></h2>
<p>Vamos instalar o OL4JSF via Maven. Para isso basta colocar a seguintes entradas no pom.xml:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;repositories&gt;</span>
<span class="c">&lt;!-- Outros repositórios omitidos --&gt;</span>
<span class="nt">&lt;repository&gt;</span>
        <span class="nt">&lt;id&gt;</span>java.net2<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;name&gt;</span>Repository hosting the jee6 artifacts<span class="nt">&lt;/name&gt;</span>
        <span class="nt">&lt;url&gt;</span>http://download.java.net/maven/2<span class="nt">&lt;/url&gt;</span>
<span class="nt">&lt;/repository&gt;</span>
<span class="nt">&lt;/repositories&gt;</span>
<span class="nt">&lt;dependencies&gt;</span>
        <span class="c">&lt;!-- Outras dependencias omitidas --&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.ol4jsf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>ol4jsf-core<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>compile<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</pre></div>
</div>
<p>Nesse altura do campeonato, o nosso pom deve estar assim:</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0&quot;</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
  <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>

    <span class="nt">&lt;groupId&gt;</span>org.latinoware.geodojo<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>geodojo<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;name&gt;</span>Geodojo Project<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;packaging&gt;</span>war<span class="nt">&lt;/packaging&gt;</span>

    <span class="nt">&lt;repositories&gt;</span>
        <span class="nt">&lt;repository&gt;</span>
            <span class="nt">&lt;id&gt;</span>java.net2<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;name&gt;</span>Repository hosting the jee6 artifacts<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;url&gt;</span>http://download.java.net/maven/2<span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;/repository&gt;</span>
        <span class="nt">&lt;repository&gt;</span>
            <span class="nt">&lt;id&gt;</span>EclipseLink Repo<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;url&gt;</span>http://www.eclipse.org/downloads/download.php?r=1<span class="ni">&amp;amp;</span>nf=1<span class="ni">&amp;amp;</span>file=/rt/eclipselink/maven.repo<span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;/repository&gt;</span>
        <span class="nt">&lt;repository&gt;</span>
            <span class="nt">&lt;id&gt;</span>OSGEO GeoTools repo<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;url&gt;</span>http://download.osgeo.org/webdav/geotools<span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;/repository&gt;</span>
        <span class="nt">&lt;repository&gt;</span>
            <span class="nt">&lt;id&gt;</span>Hibernate Spatial repo<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;url&gt;</span>http://www.hibernatespatial.org/repository<span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;/repository&gt;</span>
        <span class="c">&lt;!-- add JBOSS repository for easy access to Hibernate libraries --&gt;</span>
        <span class="nt">&lt;repository&gt;</span>
            <span class="nt">&lt;id&gt;</span>JBOSS<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;url&gt;</span>http://repository.jboss.com/maven2<span class="nt">&lt;/url&gt;</span>
        <span class="nt">&lt;/repository&gt;</span>

    <span class="nt">&lt;/repositories&gt;</span>

    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>

    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;configuration&gt;</span>
                    <span class="nt">&lt;source&gt;</span>1.6<span class="nt">&lt;/source&gt;</span>
                    <span class="nt">&lt;target&gt;</span>1.6<span class="nt">&lt;/target&gt;</span>
                <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/build&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>javax.servlet<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>jstl<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>javax.servlet<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>servlet-api<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.5<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>hsqldb<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>hsqldb<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.8.0.10<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>compile<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>javax.enterprise<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>cdi-api<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.0-SP1<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>compile<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.jboss.weld<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>weld-api<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.0-SP1<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.jboss.weld.servlet<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>weld-servlet<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.0.1-Final<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.sun.faces<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>jsf-api<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.0.3<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>compile<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.sun.faces<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>jsf-impl<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.0.3<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>hibernate<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>hibernate-entitymanager<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>3.4.0.GA<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="c">&lt;!-- the Postgis JDBC driver --&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.postgis<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>postgis-jdbc<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.3.3<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="c">&lt;!-- the postgresql driver --&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>postgresql<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>postgresql<span class="nt">&lt;/artifactId&gt;</span>
            <span class="c">&lt;!-- scope&gt;provided&lt;/scope&gt;  --&gt;</span>
            <span class="nt">&lt;version&gt;</span>8.4-701.jdbc3<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="c">&lt;!-- Hibernate uses slf4j for logging, for our purposes here use the simple backend --&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>slf4j-simple<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.5.6<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.slf4j<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>slf4j-api<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.5.6<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="c">&lt;!-- GIS DEPENDENCIES --&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.ol4jsf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>ol4jsf-core<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>2.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>compile<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.hibernatespatial<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>hibernate-spatial-postgis<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="exibindo-nosso-primeiro-mapa">
<h2><a class="toc-backref" href="#id4">Exibindo nosso primeiro mapa</a><a class="headerlink" href="#exibindo-nosso-primeiro-mapa" title="Permalink to this headline">¶</a></h2>
<p>Vamos criar uma página para exibir a layer &#8216;world&#8217; adicionada ao geoserver no capítulo anterior.</p>
<ol class="arabic simple">
<li>Clique com o botão direito sobre o diretório <em>geodojo/src/main/webapps</em> e escolha a opção <em>HTML File</em>. A seguinte tela deverá aparecer:</li>
</ol>
<a class="reference internal image-reference" href="../_images/ol4jsf_1.png"><img alt="../_images/ol4jsf_1.png" src="../_images/ol4jsf_1.png" style="width: 367.8px; height: 377.4px;" /></a>
<ol class="arabic simple" start="2">
<li>Digite o nome <em>worldmap.xhtml</em> e, em seguida, clique em next.</li>
</ol>
<a class="reference internal image-reference" href="../_images/ol4jsf_2.png"><img alt="../_images/ol4jsf_2.png" src="../_images/ol4jsf_2.png" style="width: 367.8px; height: 377.4px;" /></a>
<ol class="arabic simple" start="3">
<li>Selecione a opção <em>New XHTML File (1.0 transitional)</em> e finish.</li>
<li>Substitua o código gerado pelo abaixo:</li>
</ol>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
          <span class="na">xmlns:h=</span><span class="s">&quot;http://java.sun.com/jsf/html&quot;</span>
      <span class="na">xmlns:f=</span><span class="s">&quot;http://java.sun.com/jsf/core&quot;</span>
      <span class="na">xmlns:ui=</span><span class="s">&quot;http://java.sun.com/jsf/facelets&quot;</span>
                <span class="na">xmlns:m=</span><span class="s">&quot;http://www.ol4jsf.org&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;h:head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span>OL4JSF World Map<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/h:head&gt;</span>
<span class="nt">&lt;h:body&gt;</span>
        <span class="nt">&lt;m:map</span> <span class="na">width=</span><span class="s">&quot;512px&quot;</span> <span class="na">height=</span><span class="s">&quot;256px&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer&quot;</span> <span class="na">url=</span><span class="s">&quot;http://localhost:8082/geoserver/wms&quot;</span> <span class="na">params=</span><span class="s">&quot;{layers:&#39;world&#39;}&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/m:map&gt;</span>
<span class="nt">&lt;/h:body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div>
<ol class="arabic simple" start="5">
<li>Execute o projeto e veja o resultado.</li>
</ol>
<a class="reference internal image-reference" href="../_images/ol4jsf_3.png"><img alt="../_images/ol4jsf_3.png" src="../_images/ol4jsf_3.png" style="width: 515.4px; height: 322.2px;" /></a>
<p>Muito simples, não? :)</p>
<p>Acabamos de exibir um mapa contendo uma única camada vinda do GeoServer. Que tal adicionarmos mais controles ao mapa?</p>
<div class="section" id="adicionando-controles">
<h3><a class="toc-backref" href="#id5">Adicionando controles</a><a class="headerlink" href="#adicionando-controles" title="Permalink to this headline">¶</a></h3>
<p>No OL4JSF existem dois grandes grupos de componentes: &lt;nome&gt;Layer e &lt;nome&gt;Control. Os pertencentes ao primeiro grupo são componentes que representam camadas (wms, wfs, google, etc). Já o segundo grupo, são controles (zoom, layerSwitch, etc).</p>
<p>Vamos incrementar nosso mapa com alguns controles, alterando o xhtml anterior e deixando-o assim:</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
        <span class="na">xmlns:h=</span><span class="s">&quot;http://java.sun.com/jsf/html&quot;</span>
        <span class="na">xmlns:f=</span><span class="s">&quot;http://java.sun.com/jsf/core&quot;</span>
        <span class="na">xmlns:ui=</span><span class="s">&quot;http://java.sun.com/jsf/facelets&quot;</span>
        <span class="na">xmlns:m=</span><span class="s">&quot;http://www.ol4jsf.org&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;h:head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span>OL4JSF World Map<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/h:head&gt;</span>
<span class="nt">&lt;h:body&gt;</span>
        <span class="nt">&lt;m:map</span> <span class="na">width=</span><span class="s">&quot;512px&quot;</span> <span class="na">height=</span><span class="s">&quot;256px&quot;</span> <span class="na">options=</span><span class="s">&quot;{controls: [], numZoomLevels: 6}&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer Bluemarble&quot;</span>
                        <span class="na">url=</span><span class="s">&quot;http://localhost:8082/geoserver/wms&quot;</span> <span class="na">params=</span><span class="s">&quot;{layers:&#39;geodojo:bluemarble&#39;}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer ADM&quot;</span>
                        <span class="na">url=</span><span class="s">&quot;http://localhost:8082/geoserver/wms&quot;</span> <span class="na">params=</span><span class="s">&quot;{layers:&#39;geodojo:world_adm&#39;,transparent:true}&quot;</span> <span class="na">options=</span><span class="s">&quot;{isBaseLayer:false}&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;m:navigationControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:panZoomBarControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:layerSwitcherControl</span> <span class="na">options=</span><span class="s">&quot;{ascending:false}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:scaleLineControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:mousePositionControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:overviewMapControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:keyboardDefaultsControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:permalinkControl</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/m:map&gt;</span>
<span class="nt">&lt;/h:body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Observem que tanto no atributo <em>options</em> quanto no <em>params</em> utilizamos um hash javascript passando parâmetros adicionais ao nosso componente.</p>
<a class="reference internal image-reference" href="../_images/ol4jsf_4.png"><img alt="../_images/ol4jsf_4.png" src="../_images/ol4jsf_4.png" style="width: 568.8px; height: 320.4px;" /></a>
<p>Aproveite para perceber o que cada componente faz no mapa! Não tenha medo de usá-los! ;)</p>
</div>
<div class="section" id="obtendo-mais-informacoes-a-partir-do-mapa">
<h3><a class="toc-backref" href="#id6">Obtendo mais informações a partir do mapa</a><a class="headerlink" href="#obtendo-mais-informacoes-a-partir-do-mapa" title="Permalink to this headline">¶</a></h3>
<p>Que tal ao clicarmos no nosso mapa exibirmos um balão como o da figura abaixo?</p>
<a class="reference internal image-reference" href="../_images/ol4jsf_5.png"><img alt="../_images/ol4jsf_5.png" src="../_images/ol4jsf_5.png" style="width: 501.6px; height: 258.0px;" /></a>
<p>Você pode ficar tentado em fazer o código abaixo.</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
        <span class="na">xmlns:h=</span><span class="s">&quot;http://java.sun.com/jsf/html&quot;</span>
        <span class="na">xmlns:f=</span><span class="s">&quot;http://java.sun.com/jsf/core&quot;</span>
        <span class="na">xmlns:ui=</span><span class="s">&quot;http://java.sun.com/jsf/facelets&quot;</span>
        <span class="na">xmlns:m=</span><span class="s">&quot;http://www.ol4jsf.org&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;h:head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span>OL4JSF World Map<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/h:head&gt;</span>
<span class="nt">&lt;h:body&gt;</span>
        <span class="nt">&lt;m:map</span> <span class="na">width=</span><span class="s">&quot;512px&quot;</span> <span class="na">height=</span><span class="s">&quot;256px&quot;</span> <span class="na">options=</span><span class="s">&quot;{controls: [], numZoomLevels: 6}&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer Bluemarble&quot;</span>
                        <span class="na">url=</span><span class="s">&quot;http://localhost:8082/geoserver/wms&quot;</span> <span class="na">params=</span><span class="s">&quot;{layers:&#39;geodojo:bluemarble&#39;}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer ADM&quot;</span>
                        <span class="na">url=</span><span class="s">&quot;http://localhost:8082/geoserver/wms&quot;</span> <span class="na">params=</span><span class="s">&quot;{layers:&#39;geodojo:world_adm&#39;,transparent:true}&quot;</span> <span class="na">options=</span><span class="s">&quot;{isBaseLayer:false}&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;m:featureInfoPopup</span> <span class="na">url=</span><span class="s">&quot;http://localhost:8082/geoserver/wms&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:navigationControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:panZoomBarControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:layerSwitcherControl</span> <span class="na">options=</span><span class="s">&quot;{ascending:false}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:scaleLineControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:mousePositionControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:overviewMapControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:keyboardDefaultsControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:permalinkControl</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/m:map&gt;</span>
<span class="nt">&lt;/h:body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Observem na linha 18 a utilização do componente <em>&lt;m:featureInfoPopup /&gt;</em>. Extremamente simples. Entretanto, existe uma restrição no OpenLayers que não permite que obtenhamos informações de uma camada a partir de um servidor de mapas, no nosso caso o GeoServer, que não esteja no subdomínio da aplicação.</p>
<p>Url de nossa aplicação:</p>
<div class="highlight-python"><pre>http://localhost:8080/geodojo</pre>
</div>
<p>Url de nosso servidor de mapas:</p>
<div class="highlight-python"><pre>http://localhost:8082/geoserver</pre>
</div>
<p>O mais chato é que não é retornado nenhum erro. Simplesmente não funciona!</p>
</div>
<div class="section" id="ol4jsf-proxy">
<h3><a class="toc-backref" href="#id7">OL4JSF Proxy</a><a class="headerlink" href="#ol4jsf-proxy" title="Permalink to this headline">¶</a></h3>
<p>Para resolver essas e outras questões o OL4JSF vem com um servlet que funciona como um proxy entre a sua aplicação e o servidor de mapas. Para instalá-lo basta adicionar a seguinte entrada ao seu web.xml:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;servlet&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>OL4JSFProxy<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;servlet-class&gt;</span>org.ol4jsf.proxy.servlet.OL4JSFProxy<span class="nt">&lt;/servlet-class&gt;</span>
<span class="nt">&lt;/servlet&gt;</span>

<span class="nt">&lt;servlet-mapping&gt;</span>
    <span class="nt">&lt;servlet-name&gt;</span>OL4JSFProxy<span class="nt">&lt;/servlet-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/OL4JSFProxy/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/servlet-mapping&gt;</span>
</pre></div>
</div>
<p>O OL4JSF esperar um arquivo com nome ol4jsf-proxy.xml no seu classpath. É nele onde faremos a configuração do proxy.</p>
<ol class="arabic simple">
<li>Clique com o botão direito em <em>geodojo/src/resources -&gt; New -&gt; Other... -&gt; XML -&gt; XML File</em>.</li>
</ol>
<a class="reference internal image-reference" href="../_images/ol4jsf_6.png"><img alt="../_images/ol4jsf_6.png" src="../_images/ol4jsf_6.png" style="width: 367.8px; height: 300.0px;" /></a>
<ol class="arabic simple" start="2">
<li>Clique em próximo e coloque no nome <em>ol4jsf-proxy.xml</em>.</li>
<li>Coloque o seguinte conteúdo no arquivo:</li>
</ol>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;ol4jsf-proxy&gt;</span>
        <span class="nt">&lt;use-environment</span> <span class="na">id=</span><span class="s">&quot;desenv&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&quot;desenv&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;description&gt;</span>Development Environment.<span class="nt">&lt;/description&gt;</span>
                <span class="nt">&lt;resources&gt;</span>
                        <span class="nt">&lt;resource</span> <span class="na">name=</span><span class="s">&quot;wfs&quot;</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;url&gt;</span>http://localhost:8082/geoserver/wfs<span class="nt">&lt;/url&gt;</span>
                        <span class="nt">&lt;/resource&gt;</span>
                        <span class="nt">&lt;resource</span> <span class="na">name=</span><span class="s">&quot;wms&quot;</span><span class="nt">&gt;</span>
                                <span class="nt">&lt;url&gt;</span>http://localhost:8082/geoserver/wms<span class="nt">&lt;/url&gt;</span>
                        <span class="nt">&lt;/resource&gt;</span>
                <span class="nt">&lt;/resources&gt;</span>
        <span class="nt">&lt;/environment&gt;</span>
<span class="nt">&lt;/ol4jsf-proxy&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Nesse arquivo podemos configurar vários ambientes (<em>environment</em>), porém apenas um pode estar ativo (<em>use-environment</em>). É dentro dos ambientes que configuramos os recursos (<em>resource</em>) que queremos obter através do proxy. O recurso é obtido no formato:</p>
<div class="highlight-python"><pre>&lt;URL da Aplicação&gt;/OL4JSFProxy/&lt;resource_name&gt;</pre>
</div>
<p>Agora sim! Vamos colocar o nosso balão pra funcionar. Basta alterarmos o conteúdo do nosso arquivo wordmap.xhtml.</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
        <span class="na">xmlns:h=</span><span class="s">&quot;http://java.sun.com/jsf/html&quot;</span>
        <span class="na">xmlns:f=</span><span class="s">&quot;http://java.sun.com/jsf/core&quot;</span>
        <span class="na">xmlns:ui=</span><span class="s">&quot;http://java.sun.com/jsf/facelets&quot;</span>
        <span class="na">xmlns:m=</span><span class="s">&quot;http://www.ol4jsf.org&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;h:head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span>OL4JSF World Map<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/h:head&gt;</span>
<span class="nt">&lt;h:body&gt;</span>
        <span class="nt">&lt;m:map</span> <span class="na">width=</span><span class="s">&quot;512px&quot;</span> <span class="na">height=</span><span class="s">&quot;256px&quot;</span>
                <span class="na">options=</span><span class="s">&quot;{controls: [], numZoomLevels: 6}&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer Bluemarble&quot;</span>
                        <span class="na">url=</span><span class="s">&quot;#{facesContext.externalContext.requestContextPath}/OL4JSFProxy/wms&quot;</span>
                        <span class="na">params=</span><span class="s">&quot;{layers:&#39;geodojo:bluemarble&#39;}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer ADM&quot;</span>
                        <span class="na">url=</span><span class="s">&quot;#{facesContext.externalContext.requestContextPath}/OL4JSFProxy/wms&quot;</span>
                        <span class="na">params=</span><span class="s">&quot;{layers:&#39;geodojo:world_adm&#39;,transparent:true}&quot;</span>
                        <span class="na">options=</span><span class="s">&quot;{isBaseLayer:false}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:featureInfoPopup</span>
                        <span class="na">url=</span><span class="s">&quot;#{facesContext.externalContext.requestContextPath}/OL4JSFProxy/wms&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/m:featureInfoPopup&gt;</span>
                <span class="nt">&lt;m:navigationControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:panZoomBarControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:layerSwitcherControl</span> <span class="na">options=</span><span class="s">&quot;{ascending:false}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:scaleLineControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:mousePositionControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:overviewMapControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:keyboardDefaultsControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:permalinkControl</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/m:map&gt;</span>
<span class="nt">&lt;/h:body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="obtendo-features-a-partir-de-um-backing-bean">
<h3><a class="toc-backref" href="#id8">Obtendo features a partir de um backing bean</a><a class="headerlink" href="#obtendo-features-a-partir-de-um-backing-bean" title="Permalink to this headline">¶</a></h3>
<p>Que tal plotarmos agora algumas geometrias provenientes de uma classe java? Simples!</p>
<ol class="arabic simple">
<li>Crie a classe <em>org.latinoware.geodojo.app.bean.WorldMapBean</em>.</li>
<li>Coloque o seguinte conteúdo na classe:</li>
</ol>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre>        <span class="kn">package</span> <span class="n">org</span><span class="o">.</span><span class="na">latinoware</span><span class="o">.</span><span class="na">geodojo</span><span class="o">.</span><span class="na">app</span><span class="o">.</span><span class="na">bean</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.annotation.PostConstruct</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.enterprise.inject.Model</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.ol4jsf.util.WKTFeaturesCollection</span><span class="o">;</span>

<span class="nd">@Model</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WorldMapBean</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">wkts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>

    <span class="nd">@PostConstruct</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fillFeatures</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">wkts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;POLYGON((-117.421875 58.7109375, -120.234375 36.2109375, -99.140625 29.1796875, -83.671875 41.1328125, -81.5625 46.7578125, -117.421875 58.7109375))&quot;</span><span class="o">);</span>
        <span class="n">wkts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;LINESTRING(21.796875 50.2734375, 53.4375 56.6015625, 51.328125 39.0234375, 75.234375 43.9453125, 98.4375 42.5390625, 96.328125 27.7734375, 106.875 34.8046875)&quot;</span><span class="o">);</span>
        <span class="n">wkts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="s">&quot;POINT(-56.25 -11.6015625)&quot;</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getWkts</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">WKTFeaturesCollection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">features</span> <span class="o">=</span> <span class="k">new</span> <span class="n">WKTFeaturesCollection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
        <span class="n">features</span><span class="o">.</span><span class="na">addAllFeatures</span><span class="o">(</span><span class="n">wkts</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">features</span><span class="o">.</span><span class="na">toMap</span><span class="o">();</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>Observem que criamos um bean CDI e adicionamos um ponto, uma linha e um polígono logo após a inicialização. No método getWkts, retornamos as geometrias utilizando uma classe utilitário do OL4JSF.</p>
<ol class="arabic" start="3">
<li><p class="first">Criar uma camada vetorial que possua como valor a propriedade do backing bean:</p>
<div class="highlight-python"><pre>&lt;m:vectorLayer name="Geometrias" value="#{worldMapBean.wkts}" /&gt;</pre>
</div>
</li>
</ol>
<p>Segue o código completo da página:</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&quot;&gt;</span>
<span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span>
        <span class="na">xmlns:h=</span><span class="s">&quot;http://java.sun.com/jsf/html&quot;</span>
        <span class="na">xmlns:f=</span><span class="s">&quot;http://java.sun.com/jsf/core&quot;</span>
        <span class="na">xmlns:ui=</span><span class="s">&quot;http://java.sun.com/jsf/facelets&quot;</span>
        <span class="na">xmlns:m=</span><span class="s">&quot;http://www.ol4jsf.org&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;h:head&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;Content-Type&quot;</span> <span class="na">content=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;title&gt;</span>OL4JSF World Map<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/h:head&gt;</span>
<span class="nt">&lt;h:body&gt;</span>
        <span class="nt">&lt;m:map</span> <span class="na">width=</span><span class="s">&quot;512px&quot;</span> <span class="na">height=</span><span class="s">&quot;256px&quot;</span>
                <span class="na">options=</span><span class="s">&quot;{controls: [], numZoomLevels: 6}&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer Bluemarble&quot;</span>
                        <span class="na">url=</span><span class="s">&quot;#{facesContext.externalContext.requestContextPath}/OL4JSFProxy/wms&quot;</span>
                        <span class="na">params=</span><span class="s">&quot;{layers:&#39;geodojo:bluemarble&#39;}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:wmsLayer</span> <span class="na">name=</span><span class="s">&quot;World Layer ADM&quot;</span>
                        <span class="na">url=</span><span class="s">&quot;#{facesContext.externalContext.requestContextPath}/OL4JSFProxy/wms&quot;</span>
                        <span class="na">params=</span><span class="s">&quot;{layers:&#39;geodojo:world_adm&#39;,transparent:true}&quot;</span>
                        <span class="na">options=</span><span class="s">&quot;{isBaseLayer:false}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:vectorLayer</span> <span class="na">name=</span><span class="s">&quot;Geometrias&quot;</span> <span class="na">value=</span><span class="s">&quot;#{worldMapBean.wkts}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:featureInfoPopup</span>
                        <span class="na">url=</span><span class="s">&quot;#{facesContext.externalContext.requestContextPath}/OL4JSFProxy/wms&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;/m:featureInfoPopup&gt;</span>
                <span class="nt">&lt;m:navigationControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:panZoomBarControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:layerSwitcherControl</span> <span class="na">options=</span><span class="s">&quot;{ascending:false}&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:scaleLineControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:mousePositionControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:overviewMapControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:keyboardDefaultsControl</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;m:permalinkControl</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/m:map&gt;</span>
<span class="nt">&lt;/h:body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Teremos como resultado:</p>
<a class="reference internal image-reference" href="../_images/ol4jsf_7.png"><img alt="../_images/ol4jsf_7.png" src="../_images/ol4jsf_7.png" style="width: 504.0px; height: 259.8px;" /></a>
<p>Observem que essas geometrias poderiam ter vindo de um SGBD, por exemplo. Colocamos estáticas por mera conveniência. ;)</p>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <ul id="breadcrumbs">
            <li class="right" style="margin-right: 10px">
              <a href="../genindex.html" title="General Index"
                 >index</a></li>
            <li class="right" >
              <a href="../8-exemplo1/exemplo1.html" title="Exemplo1 - Enviando um geotwitt"
                 >next</a> |</li>
            <li class="right" >
              <a href="../6-geoserver/geoserver.html" title="Serviço de Mapas na Web - Geoserver"
                 >previous</a> |</li>
        <li><a href="../index.html">GeoDOJO vGeoDOJO documentation</a> &raquo;</li>
        <li><a href="#">Disponibilizando os mapas de forma rica na web - OpenLayers &amp; Ol4JSF</a></li>
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010, Rafael Soto e Robert Anderson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.4.
    </div>
  </body>
</html>